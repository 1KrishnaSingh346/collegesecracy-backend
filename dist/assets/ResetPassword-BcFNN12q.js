import{c as E,O as q,a as D,u as v,r,j as e,P as W,V as n}from"./index-os3KaEe5.js";import{M as H}from"./mail-CBrJ8sa_.js";import{C as U}from"./circle-check-big-Db7JZ0ze.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],M=E("EyeOff",Y);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],T=E("Eye",G),X=()=>{const[N]=q(),g=D(),c=N.get("token"),m=N.get("email"),F=v(s=>s.resetPassword),V=v(s=>s.verifyEmail),$=v(s=>s.isLoading),[o,z]=r.useState({password:"",confirmPassword:""}),[h,f]=r.useState({password:"",confirmPassword:""}),[w,R]=r.useState(!1),[p,L]=r.useState(!1),[u,y]=r.useState(!0),[A,b]=r.useState(!0),[B,P]=r.useState(!1),[i,k]=r.useState(!1);r.useEffect(()=>{(async()=>{if(b(!0),!c||!m){y(!1),n.error("Invalid reset link. Missing token or email."),b(!1);return}try{const a=await V(c,m,"reset");a.success||(y(!1),n.error(a.message||"This reset link has expired or is invalid."))}catch{y(!1),n.error("Failed to verify reset link. Please try again.")}finally{b(!1)}})()},[c,m]),r.useEffect(()=>{if(!u){const s=setTimeout(()=>g("/login"),6e3);return()=>clearTimeout(s)}},[u,g]);const C=s=>{const{name:a,value:d}=s.target;z(t=>({...t,[a]:d})),f(t=>({...t,[a]:""}))},S=s=>{if(!s)return{text:"",strength:0};if(s.length<8)return{text:"Too short",strength:0};const a=/[a-z]/.test(s),d=/[A-Z]/.test(s),t=/\d/.test(s),j=/[@$!%*?&#]/.test(s),x=[a,d,t,j].filter(Boolean).length;return{text:x===4?"Strong":x===3?"Good":x===2?"Fair":"Weak",strength:x}},I=async s=>{s.preventDefault();const a={},{text:d}=S(o.password);if(o.password.length<8?a.password="Password must be at least 8 characters":d==="Weak"&&(a.password="Password is too weak"),o.password!==o.confirmPassword&&(a.confirmPassword="Passwords do not match"),Object.keys(a).length>0){f(a);return}k(!0);try{const t=await F(c,m,o.password);t!=null&&t.success?(n.success("Password reset successfully! Redirecting to login..."),setTimeout(()=>g("/login"),1500)):t!=null&&t.message&&t.message.toLowerCase().includes("same as the old")?(f(j=>({...j,password:"New password cannot be the same as the old one."})),n.error("Try a different password. This one matches your old password.")):n.error((t==null?void 0:t.message)||"Password reset failed. Please try again.")}catch{n.error("An error occurred during password reset. Please try again.")}finally{k(!1)}},{text:_,strength:l}=S(o.password),O=["text-red-500","text-yellow-500","text-blue-500","text-green-500"];return e.jsxs("div",{className:"min-h-screen flex items-center justify-center px-4 bg-gray-900 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 overflow-hidden opacity-20",children:[...Array(20)].map((s,a)=>e.jsx("div",{className:"absolute rounded-full bg-indigo-500",style:{width:`${Math.random()*10+2}px`,height:`${Math.random()*10+2}px`,top:`${Math.random()*100}%`,left:`${Math.random()*100}%`,opacity:Math.random()*.5+.1,animation:`float ${Math.random()*10+10}s linear infinite`}},a))}),A?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center space-y-4 z-10",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-indigo-900/30 flex items-center justify-center",children:e.jsx(W,{className:"w-8 h-8 animate-spin text-indigo-400"})}),e.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-indigo-400 border-t-transparent animate-spin"})]}),e.jsx("p",{className:"text-sm text-gray-300 font-medium",children:"Verifying reset link..."}),e.jsx("p",{className:"text-xs text-gray-500",children:"Please wait while we validate your request"})]}):e.jsxs("div",{className:"bg-gray-800 text-white w-full max-w-md p-8 rounded-xl shadow-lg border border-gray-700 space-y-6 z-10 backdrop-blur-sm",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("div",{className:"mx-auto w-12 h-12 rounded-full bg-indigo-900/50 flex items-center justify-center",children:e.jsx(H,{className:"w-5 h-5 text-indigo-400"})}),e.jsx("h2",{className:"text-2xl font-bold",children:"Reset Your Password"}),e.jsx("p",{className:"text-gray-400 text-sm",children:u?"Enter a new password for your account":"This password reset link is no longer valid"})]}),u?e.jsxs("form",{onSubmit:I,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:w?"text":"password",id:"password",name:"password",value:o.password,onChange:C,onFocus:()=>P(!0),onBlur:()=>P(!1),required:!0,disabled:i,className:"w-full px-4 py-3 rounded-lg bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 border border-gray-600 disabled:opacity-70 disabled:cursor-not-allowed",placeholder:"Enter your new password"}),e.jsx("button",{type:"button",onClick:()=>R(!w),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-300",disabled:i,children:w?e.jsx(M,{className:"w-5 h-5"}):e.jsx(T,{className:"w-5 h-5"})})]}),(B||o.password)&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"Strength"}),e.jsx("span",{className:`text-xs font-medium ${O[l]||"text-gray-400"}`,children:_||"Too short"})]}),e.jsx("div",{className:"w-full mt-1 bg-gray-600 rounded-full h-1.5",children:e.jsx("div",{className:`h-1.5 rounded-full transition-all duration-300 ${l===1?"bg-red-500":l===2?"bg-yellow-500":l===3?"bg-blue-500":l===4?"bg-green-500":"bg-transparent"}`,style:{width:`${l/4*100}%`}})})]}),h.password&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:h.password})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p?"text":"password",id:"confirmPassword",name:"confirmPassword",value:o.confirmPassword,onChange:C,required:!0,disabled:i,className:"w-full px-4 py-3 rounded-lg bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 border border-gray-600 disabled:opacity-70 disabled:cursor-not-allowed",placeholder:"Confirm your new password"}),e.jsx("button",{type:"button",onClick:()=>L(!p),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-300",disabled:i,children:p?e.jsx(M,{className:"w-5 h-5"}):e.jsx(T,{className:"w-5 h-5"})})]}),h.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:h.confirmPassword})]}),e.jsx("button",{type:"submit",disabled:$||i,className:`w-full py-3 rounded-lg font-semibold transition duration-200 flex items-center justify-center gap-2
                  ${i?"bg-indigo-800 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"}
                `,children:i?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Updating Password..."]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"w-5 h-5"}),"Reset Password"]})})]}):e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"p-4 bg-gray-700/50 rounded-lg border border-gray-600 flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:e.jsx("svg",{className:"w-5 h-5 text-yellow-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-300 font-medium",children:"This password reset link is invalid or has expired."}),e.jsxs("p",{className:"mt-2 text-sm text-gray-400 leading-relaxed",children:["For your security, reset links are time-bound and become invalid after use.",e.jsx("br",{}),"You'll be automatically redirected to the login page in a few seconds."]})]})]})})]})]})};export{X as default};
