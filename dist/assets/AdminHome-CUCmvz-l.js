import{u as v,r as m,j as e,L as x}from"./index-os3KaEe5.js";import{S as r}from"./skeleton-CmXXhd2Y.js";function i(d){return new Intl.NumberFormat().format(d)}const U=()=>{const{AllUsers:d,fetchAllUsers:o,isfetchingUser:g}=v(),[a,l]=m.useState({totalUsers:0,activeToday:0,premiumUsers:0,mentors:0,students:0,newThisWeek:0,hasToolsOrPlans:0}),[u,j]=m.useState([]),[f,p]=m.useState(!0);m.useEffect(()=>{(async()=>{p(!0);try{await o()}finally{p(!1)}})()},[o]),m.useEffect(()=>{d&&d.length>0&&N()},[d]);const N=()=>{const t=new Date;t.setHours(0,0,0,0);const n=new Date;n.setDate(n.getDate()-7);const h={totalUsers:d.length,activeToday:d.filter(s=>s.lastActive&&new Date(s.lastActive)>=t).length,hasToolsOrPlans:d.filter(s=>s.premiumTools&&s.premiumTools.length>0||s.counselingPlans&&s.counselingPlans.length>0).length,mentors:d.filter(s=>s.role==="mentor").length,students:d.filter(s=>s.role==="mentee").length,newThisWeek:d.filter(s=>s.createdAt&&new Date(s.createdAt)>=n).length};l(h),w()},w=()=>{const h=[...d].sort((s,c)=>new Date(c.lastActive)-new Date(s.lastActive)).slice(0,5).map(s=>{var c,b;return{id:s._id,name:s.fullName||"Unknown User",action:s.lastActive?"Was active":"Registered",time:s.lastActive||s.createdAt,role:s.role,profilePic:((c=s.profilePic)==null?void 0:c.url)||null,avatarText:!((b=s.profilePic)!=null&&b.url)&&s.fullName?s.fullName.charAt(0).toUpperCase():"U",hasSubscription:s.premiumTools&&s.premiumTools.length>0||s.counselingPlans&&s.counselingPlans.length>0}});j(h)};return g||f?e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx(r,{height:32,width:200,className:"mb-6"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[...Array(3)].map((t,n)=>e.jsxs("div",{className:"p-4 rounded-lg border",children:[e.jsx(r,{height:24,width:120}),e.jsx(r,{height:32,className:"mt-2"}),n===0&&e.jsx(r,{height:20,width:100,className:"mt-1"}),n===2&&e.jsxs("div",{className:"flex justify-between mt-2",children:[e.jsx(r,{height:20,width:80}),e.jsx(r,{height:20,width:80})]})]},n))}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx(r,{height:24,width:150,className:"mb-4"}),e.jsx("div",{className:"flex justify-between",children:[...Array(3)].map((t,n)=>e.jsxs("div",{className:"w-1/3 text-center",children:[e.jsx(r,{height:28,className:"mx-auto",width:60}),e.jsx(r,{height:16,width:80,className:"mt-1 mx-auto"})]},n))})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx(r,{height:24,width:150,className:"mb-4"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[...Array(4)].map((t,n)=>e.jsx(r,{height:48},n))})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx(r,{height:24,width:150,className:"mb-4"}),[...Array(3)].map((t,n)=>e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(r,{circle:!0,width:40,height:40,className:"mr-3"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(r,{height:16,width:120}),e.jsx(r,{height:14,width:180,className:"mt-1"})]}),e.jsx(r,{height:20,width:60})]},n))]})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 md:p-6",children:[e.jsx("h2",{className:"text-xl md:text-2xl font-bold text-gray-800 mb-6",children:"Admin Dashboard Overview"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6 mb-6",children:[e.jsx("div",{className:"bg-blue-50 p-3 md:p-4 rounded-lg border border-blue-100",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm md:text-base font-semibold text-blue-800",children:"Total Users"}),e.jsx("p",{className:"text-2xl md:text-3xl font-bold mt-1 md:mt-2",children:i(a.totalUsers)})]}),e.jsxs("div",{className:"text-xs md:text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded",children:["+",i(a.newThisWeek)," this week"]})]})}),e.jsxs("div",{className:"bg-green-50 p-3 md:p-4 rounded-lg border border-green-100",children:[e.jsx("h3",{className:"text-sm md:text-base font-semibold text-green-800",children:"Active Today"}),e.jsx("p",{className:"text-2xl md:text-3xl font-bold mt-1 md:mt-2",children:i(a.activeToday)}),e.jsx("p",{className:"text-xs md:text-sm text-green-600 mt-1",children:a.totalUsers>0?`${Math.round(a.activeToday/a.totalUsers*100)}% of total`:"No users"})]}),e.jsxs("div",{className:"bg-purple-50 p-3 md:p-4 rounded-lg border border-purple-100",children:[e.jsx("h3",{className:"text-sm md:text-base font-semibold text-purple-800",children:"Subscriptions"}),e.jsx("p",{className:"text-2xl md:text-3xl font-bold mt-1 md:mt-2",children:i(a.hasToolsOrPlans)}),e.jsxs("div",{className:"flex justify-between mt-2 text-xs md:text-sm",children:[e.jsxs("span",{className:"text-purple-600",children:[i(a.mentors)," Mentors"]}),e.jsxs("span",{className:"text-purple-600",children:[i(a.students)," Students"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white border rounded-lg p-3 md:p-4",children:[e.jsx("h3",{className:"text-sm md:text-base font-semibold text-gray-700 mb-3 md:mb-4",children:"User Distribution"}),e.jsxs("div",{className:"flex justify-between text-center",children:[e.jsxs("div",{className:"w-1/3",children:[e.jsx("div",{className:"text-xl md:text-2xl font-bold text-blue-600",children:a.mentors}),e.jsx("div",{className:"text-xs md:text-sm text-gray-500",children:"Mentors"})]}),e.jsxs("div",{className:"w-1/3",children:[e.jsx("div",{className:"text-xl md:text-2xl font-bold text-green-600",children:a.students}),e.jsx("div",{className:"text-xs md:text-sm text-gray-500",children:"Students"})]}),e.jsxs("div",{className:"w-1/3",children:[e.jsx("div",{className:"text-xl md:text-2xl font-bold text-purple-600",children:a.hasToolsOrPlans}),e.jsx("div",{className:"text-xs md:text-sm text-gray-500",children:"Subscribed"})]})]})]}),e.jsxs("div",{className:"bg-white border rounded-lg p-3 md:p-4",children:[e.jsx("h3",{className:"text-sm md:text-base font-semibold text-gray-700 mb-3 md:mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 md:gap-3",children:[e.jsx(x,{to:"/admin/users",className:"cursor-pointer",children:e.jsx("button",{className:"w-full bg-blue-50 text-blue-700 p-2 md:p-3 rounded-lg text-xs md:text-sm font-medium hover:bg-blue-100 transition cursor-pointer",children:"Add New User"})}),e.jsx(x,{to:"/admin/plan-event-management",className:"cursor-pointer",children:e.jsx("button",{className:"w-full bg-green-50 text-green-700 p-2 md:p-3 rounded-lg text-xs md:text-sm font-medium hover:bg-green-100 transition cursor-pointer",children:"Send Announcement"})}),e.jsx(x,{to:"/admin/payment-analytics",className:"cursor-pointer",children:e.jsx("button",{className:"w-full bg-purple-50 text-purple-700 p-2 md:p-3 rounded-lg text-xs md:text-sm font-medium hover:bg-purple-100 transition cursor-pointer",children:"View Reports"})}),e.jsx(x,{to:"/admin/plan-event-management",className:"cursor-pointer",children:e.jsx("button",{className:"w-full bg-yellow-50 text-yellow-700 p-2 md:p-3 rounded-lg text-xs md:text-sm font-medium hover:bg-yellow-100 transition cursor-pointer",children:"Manage Subs"})})]})]})]}),e.jsxs("div",{className:"bg-white border rounded-lg p-3 md:p-4",children:[e.jsx("h3",{className:"text-sm md:text-base font-semibold text-gray-700 mb-3 md:mb-4",children:"Recent Activity"}),u.length>0?e.jsx("div",{className:"space-y-3 md:space-y-4 max-h-64 overflow-y-auto pr-1 scrollbar-hide",children:u.map(t=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-8 w-8 md:h-10 md:w-10 rounded-full overflow-hidden mr-2 md:mr-3",children:t.profilePic?e.jsx("img",{src:t.profilePic,alt:t.name,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full bg-indigo-100 flex items-center justify-center",children:e.jsx("span",{className:"text-indigo-600 font-medium text-sm md:text-base",children:t.avatarText})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-xs md:text-sm font-medium text-gray-900 truncate",children:[t.name,t.hasSubscription&&e.jsx("span",{className:"ml-1 text-xs text-purple-600",children:"â˜…"})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[t.action," ",y(t.time)]})]}),e.jsx("span",{className:`ml-2 px-1 md:px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
            ${t.role==="admin"?"bg-purple-100 text-purple-800":t.role==="mentor"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:t.role==="mentee"?"Student":t.role})]},t.id))}):e.jsx("p",{className:"text-xs md:text-sm text-gray-500",children:"No recent activity"})]})]})};function y(d){if(!d)return"";const o=new Date(d),a=Math.floor((new Date-o)/1e3);let l=Math.floor(a/31536e3);return l>=1?`${l} year${l===1?"":"s"} ago`:(l=Math.floor(a/2592e3),l>=1?`${l} month${l===1?"":"s"} ago`:(l=Math.floor(a/86400),l>=1?`${l} day${l===1?"":"s"} ago`:(l=Math.floor(a/3600),l>=1?`${l} hour${l===1?"":"s"} ago`:(l=Math.floor(a/60),l>=1?`${l} minute${l===1?"":"s"} ago`:"just now"))))}export{U as default};
